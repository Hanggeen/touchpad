<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="">
  <meta name="x5-orientation" content="portrait">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta content="telephone=no" name="format-detection">
  <meta content="email=no" name="format-detection">
  <meta itemprop="name" content="try"/>
  <meta name="description" itemprop="description" content="trackpad" />
  <meta name="keywords" content="trackpad">
  <title>try</title>
  <style>
  html,body {
    width:100%;
    height:100%;
  }
  </style>
</head>
<body style="height:100%;overflow:hidden;width:100%;height:100%;position:fixed;top:0;left:0;background-color:#fff">
  <div style="position:fixed;top:0;left:0;z-index:999;width:100%;height:100%;background-color:#fff">asd</div>
  <div id="main" style="width:100%;height:100%;position:fixed;top:0;left:0;">
  </div>
<script>

// 打开一个WebSocket:
let ws = new WebSocket('ws://10.13.131.182:3000');

// 打开WebSocket连接后立刻发送一条消息:
ws.addEventListener('open', function () {
    console.log(`[CLIENT] open()`);
    ws.send('Hello!');
});

// 响应收到的消息:
ws.addEventListener('message', function (message) {
    console.log(`[CLIENT] Received: ${message}`);
})

var dom = document.getElementById('main');
var a = 0;
var X = 0, Y = 0;
var slideDiffX = 0, slideDiffY = 0;
var slideCurrentX = 0, slideCurrentY = 0;
// 开始先设置第一个开始点
dom.addEventListener('touchstart', function(e){
  slideCurrentX = e.touches[0].pageX;
  slideCurrentY = e.touches[0].pageY;
})

dom.addEventListener('touchmove', function(e){
  a++;
  console.log(new Date().valueOf())

  slideDiffX = e.touches[0].pageX - slideCurrentX;
  slideDiffY = e.touches[0].pageY - slideCurrentY;

  slideCurrentX = e.touches[0].pageX;
  slideCurrentY = e.touches[0].pageY;
  X += slideDiffX ;
  Y += slideDiffY ;
  set(X, Y)
}, false);

dom.addEventListener('touchend', function(e){})

function set(x, y) {
  document.getElementById('point').style.left = x + 'px';
  document.getElementById('point').style.top = y + 'px';
  ws.send(x*2 + ',' + y*2);
}


  </script>
</body>
</html>